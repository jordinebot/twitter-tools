var TwitterClientInterface;TwitterClientInterface=function(){function a(){this.api="api.php/?action=",this.keys={oauth:""},this.response=!1}return a.prototype.setScope=function(a){return this.scope=a},a.prototype.setTimer=function(a){return this.timeout=a},a.prototype.setAjax=function(a){return this.ajax=a},a.prototype.authenticate=function(a){return null==a&&(a="app"),null!=this.ajax&&"app"===a?this.ajax.get(this.api+"authenticate").success(function(a){return function(b){return a.keys.token=b.token}}(this)):null!=this.ajax&&"oauth"===a?(OAuth.initialize("QB3YKlQOuN5vYnXz-K2EVV9nSBw"),OAuth.popup("twitter").done(function(){return function(a){return console.log(a)}}(this))):!1},a.prototype.getUser=function(a){return null!=this.ajax?this.ajax.post(this.api+"user",{username:a}).success(function(a){return function(b){var c,d,e,f,g;if(null!=b.id?(console.log(b),a.timeout(function(){return a.scope.$apply(function(){return a.scope.user.bio=b.description,null!=b.status&&(a.scope.user.last_tweeted=b.status.created_at),a.scope.user.friends_count=b.friends_count,a.scope.user.followers_count=b.followers_count,a.scope.status.loaded.user=!0})})):a.timeout(function(){return a.scope.$apply(function(){return a.scope.status.loaded.user=!1})}),a.scope.status.loading.user=!1,null!=b.errors){for(f=b.errors,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(console.log("Error: "+c.code+" ["+c.message+"]"));return g}}}(this)):void 0},a.prototype.getUserById=function(a){return null!=this.ajax?this.ajax.post(this.api+"user_by_id",{username:a}).success(function(a){return function(b){var c,d,e,f,g;if(null!=b.id&&a.timeout(function(){return a.scope.$apply(function(){return a.scope.status.progress++,a.scope.user.followers.push({screen_name:b.screen_name,last_tweeted:null!=b.status?b.status.created_at:void 0})})}),null!=b.errors){for(f=b.errors,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(console.log("Error: "+c.code+" ["+c.message+"]"));return g}}}(this)):void 0},a.prototype.getFollowers=function(a,b){return null==b&&(b=-1),null!=this.ajax?(-1===b&&(this.scope.user.followers=[]),this.ajax.post(this.api+"followers",{username:a,cursor:b}).success(function(b){return function(c){var d,e,f,g,h,i,j,k,l,m;if((null!=(j=c.ids)?j.length:void 0)>0){for(k=c.ids,f=0,h=k.length;h>f;f++)e=k[f],b.getUserById(e);0!==c.next_cursor?b.getFollowers(a,c.next_cursor):b.scope.status.progress>=b.scope.status.overall&&(b.scope.status.loading.followers=!1,b.scope.status.loaded.followers=!0)}if(null!=c.errors){for(l=c.errors,m=[],g=0,i=l.length;i>g;g++)d=l[g],m.push(console.log("Error: "+d.code+" ["+d.message+"]"));return m}}}(this))):void 0},a}();var twitterToolsApp;twitterToolsApp=angular.module("twitterToolsApp",["yaru22.angular-timeago"]),twitterToolsApp.controller("loginController",function(a,b){var c;return b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",c=new TwitterClientInterface,c.setScope(a),c.setAjax(b),a.twitterSignIn=function(){return console.log("OAuth"),c.authenticate("oauth")}}),twitterToolsApp.controller("mainController",function(a,b,c){var d,e;return b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",e=new TwitterClientInterface,e.setScope(a),e.setTimer(c),e.setAjax(b),e.authenticate(),a.user={name:"",bio:"",last_tweeted:"",friends:[],followers:[]},a.status={loading:{user:!1,followers:!1},loaded:{user:!1,followers:!1},progress:0,overall:100},a.getUsername=function(){return a.user.name},a.getFollowers=function(){return a.status.loading.followers?console.log("Followers info is already being fetched!"):(a.status.loading.followers=!0,a.status.overall=a.user.followers_count,e.getFollowers(a.user.name))},d=function(b){return a.status.loaded.user=!1,""!==b&&(a.status.loading.user=!0),e.getUser(b)},a.$watch(a.getUsername,d)});