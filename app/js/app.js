var TwitterClientInterface;TwitterClientInterface=function(){function a(){this.api="api.php/?action=",this.keys={oauth_io:"QB3YKlQOuN5vYnXz-K2EVV9nSBw"},this.twitter=null}return a.prototype.setScope=function(a){return this.scope=a},a.prototype.setTimer=function(a){return this.timeout=a},a.prototype.setAjax=function(a){return this.ajax=a},a.prototype.authenticate=function(a){return this.method=null!=a?a:a="app",null!=this.ajax&&"app"===this.method?this.ajax.get(this.api+"authenticate").success(function(){return function(){return console.log("Application-only authentication success")}}(this)):null!=this.ajax&&"oauth"===this.method?(OAuth.initialize(this.keys.oauth_io),OAuth.popup("twitter").done(function(a){return function(b){return a.twitter=b,b.me().done(function(){return a.twitter.get("/1.1/account/verify_credentials.json").done(function(a){return console.log(a)})})}}(this))):!1},a.prototype.getUser=function(a){return null!=this.ajax&&"app"===this.method&&this.ajax.post(this.api+"user",{username:a}).success(function(a){return function(b){var c,d,e,f,g;if(null!=b.id?(console.log(b),a.timeout(function(){return a.scope.$apply(function(){return a.scope.user.bio=b.description,null!=b.status&&(a.scope.user.last_tweeted=b.status.created_at),a.scope.user.friends_count=b.friends_count,a.scope.user.followers_count=b.followers_count,a.scope.status.loaded.user=!0})})):a.timeout(function(){return a.scope.$apply(function(){return a.scope.status.loaded.user=!1})}),a.scope.status.loading.user=!1,null!=b.errors){for(f=b.errors,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(console.log("Error: "+c.code+" ["+c.message+"]"));return g}}}(this)),null!=this.ajax&&"oauth"===this.method&&null!=this.twitter?this.twitter.get("/1.1/users/show.json?screen_name="+a+"&user_id="+a).done(function(a){return function(b){return a.timeout(function(){return a.scope.$apply(function(){return a.scope.user.bio=b.description,null!=b.status&&(a.scope.user.last_tweeted=b.status.created_at),a.scope.user.friends_count=b.friends_count,a.scope.user.followers_count=b.followers_count,a.scope.status.loaded.user=!0})})}}(this)):console.log("Cannot retrieve user...")},a.prototype.getUserById=function(a,b){return null!=this.ajax&&"app"===this.method&&this.ajax.post(this.api+"user_by_id",{username:a}).success(function(a){return function(c){var d,e,f,g,h;if(null!=c.id&&a.timeout(function(){return a.scope.$apply(function(){return a.scope.status.progress++,b.push({screen_name:c.screen_name,last_tweeted:null!=c.status?c.status.created_at:0})})}),null!=c.errors){for(g=c.errors,h=[],e=0,f=g.length;f>e;e++)d=g[e],h.push(console.log("Error: "+d.code+" ["+d.message+"]"));return h}}}(this)),null!=this.ajax&&"oauth"===this.method&&null!=this.twitter?this.twitter.get("/1.1/users/show.json?user_id="+a).done(function(a){return function(c){var d,e,f,g,h;if(null!=c.id&&a.timeout(function(){return a.scope.$apply(function(){return a.scope.status.progress++,b.push({screen_name:c.screen_name,last_tweeted:null!=c.status?c.status.created_at:0})})}),null!=c.errors){for(g=c.errors,h=[],e=0,f=g.length;f>e;e++)d=g[e],h.push(console.log("Error: "+d.code+" ["+d.message+"]"));return h}}}(this)):void 0},a.prototype.getFriends=function(a,b){return null==b&&(b=-1),null!=this.ajax&&"app"===this.method&&(-1===b&&(this.scope.user.friends=[]),this.ajax.post(this.api+"friends",{username:a,cursor:b}).success(function(b){return function(c){var d,e,f,g,h,i,j,k,l,m;if((null!=(j=c.ids)?j.length:void 0)>0){for(k=c.ids,f=0,h=k.length;h>f;f++)e=k[f],b.getUserById(e,b.scope.user.friends);0!==c.next_cursor?b.getFriends(a,c.next_cursor):b.scope.status.progress>=b.scope.status.overall&&(b.scope.status.loading.friends=!1,b.scope.status.loaded.friends=!0)}if(null!=c.errors){for(l=c.errors,m=[],g=0,i=l.length;i>g;g++)d=l[g],m.push(console.log("Error: "+d.code+" ["+d.message+"]"));return m}}}(this))),null!=this.ajax&&"oauth"===this.method&&null!=this.twitter?this.twitter.get("/1.1/friends/ids.json?screen_name="+a+"&cursor="+b).done(function(b){return function(c){return b.timeout(function(){return b.scope.$apply(function(){var d,e,f,g,h,i,j,k,l,m;if((null!=(j=c.ids)?j.length:void 0)>0){for(k=c.ids,f=0,h=k.length;h>f;f++)e=k[f],b.getUserById(e,b.scope.user.friends);0!==c.next_cursor?b.getFriends(a,c.next_cursor):b.scope.status.progress>=b.scope.status.overall&&(b.scope.status.loading.friends=!1,b.scope.status.loaded.friends=!0)}if(null!=c.errors){for(l=c.errors,m=[],g=0,i=l.length;i>g;g++)d=l[g],m.push(console.log("Error: "+d.code+" ["+d.message+"]"));return m}})})}}(this)):void 0},a.prototype.getFollowers=function(a,b){return null==b&&(b=-1),null!=this.ajax&&"app"===this.method&&(-1===b&&(this.scope.user.followers=[]),this.ajax.post(this.api+"followers",{username:a,cursor:b}).success(function(b){return function(c){var d,e,f,g,h,i,j,k,l,m;if((null!=(j=c.ids)?j.length:void 0)>0){for(k=c.ids,f=0,h=k.length;h>f;f++)e=k[f],b.getUserById(e,b.scope.user.followers);0!==c.next_cursor?b.getFollowers(a,c.next_cursor):b.scope.status.progress>=b.scope.status.overall&&(b.scope.status.loading.followers=!1,b.scope.status.loaded.followers=!0)}if(null!=c.errors){for(l=c.errors,m=[],g=0,i=l.length;i>g;g++)d=l[g],m.push(console.log("Error: "+d.code+" ["+d.message+"]"));return m}}}(this))),null!=this.ajax&&"oauth"===this.method&&null!=this.twitter?this.twitter.get("/1.1/followers/ids.json?screen_name="+a+"&cursor="+b).done(function(b){return function(c){return b.timeout(function(){return b.scope.$apply(function(){var d,e,f,g,h,i,j,k,l,m;if((null!=(j=c.ids)?j.length:void 0)>0){for(k=c.ids,f=0,h=k.length;h>f;f++)e=k[f],b.getUserById(e,b.scope.user.followers);0!==c.next_cursor?b.getFollowers(a,c.next_cursor):b.scope.status.progress>=b.scope.status.overall&&(b.scope.status.loading.followers=!1,b.scope.status.loaded.followers=!0)}if(null!=c.errors){for(l=c.errors,m=[],g=0,i=l.length;i>g;g++)d=l[g],m.push(console.log("Error: "+d.code+" ["+d.message+"]"));return m}})})}}(this)):void 0},a}();var twitterToolsApp;twitterToolsApp=angular.module("twitterToolsApp",["yaru22.angular-timeago"]),twitterToolsApp.factory("twitterInterface",function(){var a;return a=new TwitterClientInterface}),twitterToolsApp.controller("loginController",function(a,b,c){return b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",c.setScope(a),c.setAjax(b),a.twitterSignIn=function(){return console.log("OAuth"),c.authenticate("oauth")}}),twitterToolsApp.controller("mainController",function(a,b,c,d){var e;return b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",d.setScope(a),d.setTimer(c),d.setAjax(b),a.user={name:"",bio:"",last_tweeted:"",friends:[],followers:[]},a.status={loading:{user:!1,friends:!1,followers:!1},loaded:{user:!1,friends:!1,followers:!1},progress:0,overall:100},a.getUsername=function(){return a.user.name},a.getFollowers=function(){return a.status.loading.followers?console.log("Followers info is already being fetched!"):(a.status.loading.followers=!0,a.status.overall=a.user.followers_count,d.getFollowers(a.user.name))},a.getFriends=function(){return a.status.loading.friends?console.log("Friends info is already being fetched!"):(a.status.loading.friends=!0,a.status.overall=a.user.friends_count,d.getFriends(a.user.name))},e=function(b){return a.status.loaded.user=!1,""!==b&&(a.status.loading.user=!0),d.getUser(b)},a.$watch(a.getUsername,e)});